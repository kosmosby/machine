/**
 * @package    AcyMailing for Joomla
 * @version    6.0.3
 * @author     acyba.com
 * @copyright  (C) 2009-2019 ACYBA S.A.R.L. All rights reserved.
 * @license    GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html
 */

jQuery(document).ready(function(_){var a,e,t,c,s,i,r;function m(){var a=_("#acym__migrate__mails").is(":checked");a?_("#acym__migrate__input__global_stats").show():_("#acym__migrate__input__global_stats").hide(),_("#acym__migrate__mailstats").prop("disabled",0==a),_("#acym__migrate__button").prop("disabled",0==_("input:checked").length)}function l(){_("#acym__migrate__no__button").prop("disabled",!0),_("#acym__migrate__button").prop("disabled",!0),_(".acym__migrate__option").prop("disabled",!0);var a={config:_("#acym__migrate__config").is(":checked")&&!_("#acym__migrate__config").hasClass("acym__migrate__migrate_with_success_element"),bounce:_("#acym__migrate__bounce").is(":checked")&&!_("#acym__migrate__bounce").hasClass("acym__migrate__migrate_with_success_element"),lists:_("#acym__migrate__lists").is(":checked")&&!_("#acym__migrate__lists").hasClass("acym__migrate__migrate_with_success_element"),mails:_("#acym__migrate__mails").is(":checked")&&!_("#acym__migrate__mails").hasClass("acym__migrate__migrate_with_success_element"),templates:_("#acym__migrate__templates").is(":checked")&&!_("#acym__migrate__templates").hasClass("acym__migrate__migrate_with_success_element"),users:_("#acym__migrate__users").is(":checked")&&!_("#acym__migrate__users").hasClass("acym__migrate__migrate_with_success_element")};a.subscriptions=a.users&&a.lists;var e=[],t=[],c=a.mails?1:0,s=_("#acym__migrate__mailstats").is(":checked")&&!_("#acym__migrate__mailstats").hasClass("acym__migrate__migrate_with_success_element")?1:0,i=a.mails&&a.lists?1:0,r=a.lists?1:0;_.each(a,function(a,m){if(1==m){var l=AJAX_URL_ACYM+"&ctrl=dashboard&task=migrate&element="+a;switch(a){case"mailStats":if(!_("#acym__migrate__mails").is(":checked"))return;break;case"templates":l+="&migratemails="+c;break;case"mails":l+="&migratemailstats="+s+"&migratemailhaslists="+i+"&migratelists="+r}e.push(l),t.push(a)}}),_("#acym__migrate__all_checked_elements").val(JSON.stringify(t)),function a(e,t){if(0==e.length)return void _("#acym__migrate__result__ok").show();var c=t.shift().toLowerCase();_("#acym__migrate__result__"+c+"__check").html('<i class="fa fa-circle-o-notch fa-spin acym__color__blue"></i>');var s=e.shift();_.post(s,function(s){"OK"==s?(_("#acym__migrate__result__"+c+"__check").html('<i class="fa fa-check-circle acym__color__green"></i>'),"mails"==c&&_("#acym__migrate__mailstats").is(":checked")&&_("#acym__migrate__result__mailstats__check").html('<i class="fa fa-check-circle acym__color__green"></i>'),_("#acym__migrate__"+c).addClass("acym__migrate__migrate_with_success_element"),a(e,t)):(_("#acym__migrate__error_element").val(c),_("#acym__migrate__result__"+c+"__check").html('<i class="fa fa-exclamation-circle acym__color__red"></i>'),"mails"==c&&_("#acym__migrate__mailstats").is(":checked")&&_("#acym__migrate__result__mailstats__check").html('<i class="fa fa-exclamation-circle acym__color__red"></i>'),_("#acym__migrate__result__error__message").html(s),_("#acym__migrate__result__error").show())}).fail(function(a){_("#acym__migrate__result").append("<br>ERROR AJAX. PLEASE REFRESH PAGE AND RETRY.")})}(e,t)}_(".acym__walk-through__select").select2({theme:"foundation",width:"100%"}),function a(){_(".acym__dashboard__active-campaings__one-campaing__action").off("click").on("click",function(){var e=AJAX_URL_ACYM+"&ctrl=campaigns&task=cancelDashboardAndGetCampaignsAjax&id="+_(this).attr("id");_.post(e,function(e){"error"==e?console.log(e):_(".acym__dashboard__active-campaings__listing").html(e),a()})})}(),_("#acym__walk-through-1__content__toggle-reply-to__checkbox").off("change").on("change",function(){_(".acym__walk-through-1__content__reply-to").toggle()}),a=_(".acym__walk-through-2__choose_your-server"),e=_(".acym__walk-through-2__choose_external-server"),t=_(".acym__walk-through-2__smtp-server"),c=_(".acym__walk-through-2__elastic-email"),s=_(".acym__walk-through-2__toggle-mail .acym__walk_through_toggle-span"),i=_(".acym__walk-through-2__choose_external-server .acym__walk_through_toggle-span"),s.off("click").on("click",function(){s.removeClass("walk-through_selected"),_(this).addClass("walk-through_selected"),"your-server"==_(this).attr("id")?a.show()&&e.hide()&&_("#acym__walk-through-2__way-mail").val(_(".your_server_selected").attr("id")):a.hide()&&e.show()&&_("#acym__walk-through-2__way-mail").val(_(".acym__walk-through-2__choose_external-server .walk-through_selected").attr("id"))}),i.off("click").on("click",function(){i.removeClass("walk-through_selected"),_(this).addClass("walk-through_selected"),"smtp"==_(this).attr("id")?t.show()&&c.hide():t.hide()&&c.show(),_("#acym__walk-through-2__way-mail").attr("value",_(this).attr("id"))}),(r=_(".acym__walk-through-2__button")).off("click").on("click",function(a){a.preventDefault(),r.addClass("unselected").removeClass("your_server_selected"),_(this).removeClass("unselected").addClass("your_server_selected"),_("#acym__walk-through-2__way-mail").attr("value",_(this).attr("id"))}),_(".acym__migrate__option").off("change").on("change",function(){m(),_(".acym__migrate__option:disabled").prop("checked",!1)}),m(),_("#acym__migrate__button").off("click").on("click",function(){l()}),_("#acym__migrate__restart_from_error__button").off("click").on("click",function(){window.scrollTo(0,0),_("#acym__migrate__result__error").hide(),_("#acym__migrate__result__error__message").html(""),l()}),_("#available_ports_check").off("click").on("click",function(a){a.preventDefault();var e=_(this).parent();e.html('<i class="fa fa-circle-o-notch fa-spin"></i>'),_.get(AJAX_URL_ACYM+"&ctrl=configuration&task=ports",function(_){e.html(_)})})});